<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>My Cloud Diary</title>

<style>
body {
  font-family: Arial;
  background: #111;
  color: white;
  text-align: center;
  padding: 15px;
}
input, textarea, button {
  width: 95%;
  padding: 12px;
  margin: 6px;
  font-size: 16px;
}
.entry {
  background: #222;
  padding: 10px;
  margin: 10px;
  border-radius: 8px;
}
.hidden { display: none; }
</style>
</head>

<body>

<h2 id="title">ğŸ” Login</h2>

<div id="loginBox">
  <input id="email" placeholder="Email">
  <input id="password" type="password" placeholder="Password">
  <button id="loginBtn">Login</button>
  <p id="msg"></p>
</div>

<div id="diary" class="hidden">
  <h2>ğŸ“” My Diary</h2>
  <textarea id="text" placeholder="Write your thoughts..."></textarea>
  <button id="saveBtn">â• Save</button>
  <div id="entries"></div>
</div>

<script type="module">

// âœ… Firebase imports
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { 
  getFirestore, 
  collection, 
  addDoc, 
  getDocs, 
  query, 
  orderBy 
} from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

// ---------- LOGIN ----------
const USER = "yusufsodiq082@gmail.com";
const PASS = "a336336a";

loginBtn.onclick = function(){
  if(email.value === USER && password.value === PASS){
    loginBox.classList.add("hidden");
    diary.classList.remove("hidden");
    title.innerText = "ğŸ“” My Diary";
    loadEntries();
  } else {
    msg.innerText = "âŒ Incorrect login or password";
  }
};

// ---------- FIREBASE CONFIG ----------
const firebaseConfig = {
  apiKey: "AIzaSyA8hfYjGN1EgB7K8x77p_ky84ssuWS8EkI",
  authDomain: "my-diary-app-ee165.firebaseapp.com",
  projectId: "my-diary-app-ee165"
};

// âœ… Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// ---------- SAVE ----------
saveBtn.onclick = async function(){
  const txt = text.value.trim();
  if(!txt) return alert("Write something!");

  await addDoc(collection(db, "diary"), {
    text: txt,
    time: Date.now()
  });

  text.value = "";
  loadEntries();
};

// ---------- LOAD ----------
async function loadEntries(){
  entries.innerHTML = "";

  const q = query(collection(db, "diary"), orderBy("time", "desc"));
  const snapshot = await getDocs(q);

  snapshot.forEach(doc => {
    const d = doc.data();
    const div = document.createElement("div");
    div.className = "entry";
    div.innerHTML = `<b>${new Date(d.time).toLocaleString()}</b><br>${d.text}`;
    entries.appendChild(div);
  });
}

</script>
</body>
</html>
